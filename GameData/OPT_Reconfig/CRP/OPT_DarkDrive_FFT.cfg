RESOURCE_DEFINITION
{
	name = OBH
	displayName = OPT Black Hole
	abbreviation = OBH
	density = 10
	unitCost = 0
	flowMode = NO_FLOW
	transfer = NONE
	isTweakable = True
	isVisible = True
	volume = 5
	ksparpicon = OPT_Reconfig/Resources/DarkGoo
	RESOURCE_DRAIN_DEFINITION
	{
		isDrainable = False
		showDrainFX = False
		drainFXPriority = 9
		drainForceISP = 5
		drainFXDefinition = particlesDraining
	}
}

@PART[engine_darkDrive]:NEEDS[!OPT_DarkGoo]
{
	@MODULE[ModuleEnginesFX]
	{
		@maxThrust = 500 // 1500
		@heatProduction = 1500 // 450
		status = Safety Open
		statusL2 = Safety Locked
		useThrustCurve = True
		!PROPELLANT[LiquidFuel] {}
		!PROPELLANT[Oxidizer] {}
		PROPELLANT
		{
			name = ElectricCharge
			ratio = 0.01
			DrawGauge = True
			minResToLeave = 2000
			ignoreForThrustCurve = True
		}
		PROPELLANT
		{
			name = OBH
			ratio = 1
			DrawGauge = True
		}
		@atmosphereCurve
		{
			!key,* = nope
			key = 0 13500000 // 0.45c
			key = 0.01 0.001
		}
		thrustCurve
		{
			// key = 0 3 0 -6.2
			// key = 1 1 0 0
			key = 0 6 -21.49414 -68.43689
			key = 0.05 4 -19.1 -19.1
			key = 0.35 1.5 -1.78 -1.78
			key = 1 1 0 0
		}
	}
	// MODULE
	// {
		// name = ModuleAlternator
		// engineIndex = 1
		// outputName = Mag Shield Power Draw
		// outputUnits = EC/s
		// RESOURCE
		// {
			// name = ElectricCharge
			// rate = -500
		// }
	// }
	MODULE
	{
		name = ModuleResourceConverter
		ConverterName = Dark Mass Production
		StartActionName = Start Dark Mass Production
		StopActionName = Stop Dark Mass Production
		ToggleActionName = Toggle Dark Mass Production
		GeneratesHeat = True
		UseSpecialistBonus = False
		AutoShutdown = True
		TemperatureModifier
		{
			key = 0 100000 0 0
			key = 2000 50000 -44.38715 -44.38715
			key = 3000 0
		}
		DefaultShutoffTemp = .8
		ThermalEfficiency 
		{
			key = 0 0 0 0
			key = 2000 1 0 0
			key = 3000 0 0 0
		}
		INPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 5000
		}
		INPUT_RESOURCE
		{
			ResourceName = Ore
			Ratio = 1
		}
		OUTPUT_RESOURCE
		{
			ResourceName = OBH
			Ratio = 0.001
		}
	}
	
	MODULE
	{
		name = ModuleCoreHeat
		CoreTempGoal = 2000					//Internal temp goal - we don't transfer till we hit this point
		CoreToPartRatio = 0.1				//Scale back cooling if the part is this % of core temp
		CoreTempGoalAdjustment = 0			//Dynamic goal adjustment
		CoreEnergyMultiplier = 0.1			//What percentage of our core energy do we transfer to the part
		HeatRadiantMultiplier = 0.05		//If the core is hotter, how much heat radiates?
		CoolingRadiantMultiplier = 0		//If the core is colder, how much radiates?
		HeatTransferMultiplier = 0			//If the part is hotter, how much heat transfers in?
		CoolantTransferMultiplier = 0.01	//If the part is colder, how much of our energy can we transfer?
		radiatorCoolingFactor = 1			//How much energy we pull from core with an active radiator?  >= 1
		radiatorHeatingFactor = 0.05		//How much energy we push to the active radiator
		MaxCalculationWarp = 1000			//Based on how dramatic the changes are, this is the max rate of change
		CoreShutdownTemp = 4000				//At what core temperature do we shut down all generators on this part?
		MaxCoolant = 3000					//Maximum amount of radiator capacity we can consume - 50 = 1 small
	}
	MODULE
	{
		name = ModuleGenerator
		isAlwaysActive = True
		INPUT_RESOURCE
		{
			name = OBH
			rate = 0.000004
			resourceFlowMode = NO_FLOW
		}
		OUTPUT_RESOURCE
		{
			name = ElectricCharge
			rate = 3
		}
	}
	RESOURCE
	{
		name = OBH
		amount = 0.1
		maxAmount = 1
	}
}

@PART[engine_darkDrive]:NEEDS[B9PartSwitch,!OPT_DarkGoo]
{
	MODULE
	{
		name = ModuleB9PartSwitch
		moduleID = DarkMassInput
		switcherDescription = Input Mass
		switcherDescriptionPlural = Input Mass Options
		switchInFlight = True
		SUBTYPE
		{
			name = Ore
			title = Ore
			descriptionSummary = <b>Inputs</b>: 1 Ore/s <br><br><color="orange">Please quicksave + quickload after applying.</color>
			primaryColor = ResourceColorOre
			secondaryColor = ResourceColorOre
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleResourceConverter
					ConverterName = Dark Mass Production
				}
				DATA
				{
					INPUT_RESOURCE
					{
						ResourceName = ElectricCharge
						Ratio = 5000
					}
					INPUT_RESOURCE
					{
						ResourceName = Ore
						Ratio = 1
					}
				}
			}
		}
		SUBTYPE
		{
			name = ROK
			title = Rock
			descriptionSummary = <b>Inputs</b>: 0.8 ROK/s <br><br><color="orange">Please quicksave + quickload after applying.</color>
			primaryColor = Desert
			secondaryColor = Desert
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleResourceConverter
					ConverterName = Dark Mass Production
				}
				DATA
				{
					INPUT_RESOURCE
					{
						ResourceName = ElectricCharge
						Ratio = 5000
					}
					INPUT_RESOURCE
					{
						ResourceName = Rock
						Ratio = 0.8
					}
				}
			}
		}
		SUBTYPE
		{
			name = LF
			title = LiquidFuel
			descriptionSummary = <b>Inputs</b>: 2 LF/s <br><br><color="orange">Please quicksave + quickload after applying.</color>
			primaryColor = ResourceColorLiquidFuel
			secondaryColor = ResourceColorLiquidFuel
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleResourceConverter
					ConverterName = Dark Mass Production
				}
				DATA
				{
					INPUT_RESOURCE
					{
						ResourceName = ElectricCharge
						Ratio = 5000
					}
					INPUT_RESOURCE
					{
						ResourceName = LiquidFuel
						Ratio = 2
					}
				}
			}
		}
		SUBTYPE
		{
			name = LFO
			title = LiquidFuel + Oxidizer
			descriptionSummary = <b>Inputs</b>: 0.9 LF/s + 1.1 OX/s <br><br><color="orange">Please quicksave + quickload after applying.</color>
			primaryColor = ResourceColorLiquidFuel
			secondaryColor = ResourceColorOxidizer
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleResourceConverter
					ConverterName = Dark Mass Production
				}
				DATA
				{
					INPUT_RESOURCE
					{
						ResourceName = ElectricCharge
						Ratio = 5000
					}
					INPUT_RESOURCE
					{
						ResourceName = LiquidFuel
						Ratio = 0.9
					}
					INPUT_RESOURCE
					{
						ResourceName = Oxidizer
						Ratio = 1.1
					}
				}
			}
		}
		SUBTYPE
		{
			name = OX
			title = Oxidizer
			descriptionSummary = <b>Inputs</b>: 2 OX/s <br><br><color="orange">Please quicksave + quickload after applying.</color>
			primaryColor = ResourceColorOxidizer
			secondaryColor = ResourceColorOxidizer
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleResourceConverter
					ConverterName = Dark Mass Production
				}
				DATA
				{
					INPUT_RESOURCE
					{
						ResourceName = ElectricCharge
						Ratio = 5000
					}
					INPUT_RESOURCE
					{
						ResourceName = Oxidizer
						Ratio = 2
					}
				}
			}
		}
		SUBTYPE
		{
			name = Mono
			title = MonoPropellant
			descriptionSummary = <b>Inputs</b>: 2.5 Mono/s <br><br><color="orange">Please quicksave + quickload after applying.</color>
			primaryColor = ResourceColorMonoPropellant
			secondaryColor = ResourceColorMonoPropellant
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleResourceConverter
					ConverterName = Dark Mass Production
				}
				DATA
				{
					INPUT_RESOURCE
					{
						ResourceName = ElectricCharge
						Ratio = 5000
					}
					INPUT_RESOURCE
					{
						ResourceName = MonoPropellant
						Ratio = 2.5
					}
				}
			}
		}
		// SUBTYPE:NEEDS[CommunityResourcePack]
		// {
			// name = IA
			// title = IntakeAtm
			// primaryColor = LightGrey
			// secondaryColor = LightGrey
			// descriptionSummary = <b>Inputs</b>: 2 IA/s <br><br><color="orange">Please quicksave + quickload after applying.</color>
			// primaryColor = LightGrey
			// secondaryColor = LightGrey
			// MODULE
			// {
				// IDENTIFIER
				// {
					// name = ModuleResourceConverter
					// ConverterName = Dark Mass Production
				// }
				// DATA
				// {
					// INPUT_RESOURCE
					// {
						// ResourceName = ElectricCharge
						// Ratio = 5000
					// }
					// INPUT_RESOURCE
					// {
						// ResourceName = IntakeAtm
						// Ratio = 2
					// }
				// }
			// }
		// }
		SUBTYPE:NEEDS[CommunityResourcePack]
		{
			name = LH2
			title = LqdHydrogen
			descriptionSummary = <b>Inputs</b>: 141.14 LH2/s <br><br><color="orange">Please quicksave + quickload after applying.</color>
			primaryColor = ResourceColorLqdHydrogen
			secondaryColor = ResourceColorLqdHydrogen
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleResourceConverter
					ConverterName = Dark Mass Production
				}
				DATA
				{
					INPUT_RESOURCE
					{
						ResourceName = ElectricCharge
						Ratio = 5000
					}
					INPUT_RESOURCE
					{
						ResourceName = LqdHydrogen
						Ratio = 141.1432 
					}
				}
			}
		}
		SUBTYPE:NEEDS[CommunityResourcePack]
		{
			name = LH2O
			title = Hydrolox
			descriptionSummary = <b>Inputs</b>: 24.741 LH2/s + 1.65 OX/s <br><br><color="orange">Please quicksave + quickload after applying.</color>
			primaryColor = ResourceColorLqdHydrogen
			secondaryColor = ResourceColorOxidizer
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleResourceConverter
					ConverterName = Dark Mass Production
				}
				DATA
				{
					INPUT_RESOURCE
					{
						ResourceName = ElectricCharge
						Ratio = 5000
					}
					INPUT_RESOURCE
					{
						ResourceName = LqdHydrogen
						Ratio = 24.741
					}
					INPUT_RESOURCE
					{
						ResourceName = Oxidizer
						Ratio = 1.6494
					}
				}
			}
		}
		SUBTYPE:NEEDS[CommunityResourcePack]
		{
			name = LCH4
			title = LqdMethane
			descriptionSummary = <b>Inputs</b>: 23.496 LCH4/s <br><br><color="orange">Please quicksave + quickload after applying.</color>
			primaryColor = ResourceColorLqdMethane
			secondaryColor = ResourceColorLqdMethane
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleResourceConverter
					ConverterName = Dark Mass Production
				}
				DATA
				{
					INPUT_RESOURCE
					{
						ResourceName = ElectricCharge
						Ratio = 5000
					}
					INPUT_RESOURCE
					{
						ResourceName = LqdMethane
						Ratio = 23.49566
					}
				}
			}
		}
		SUBTYPE:NEEDS[CommunityResourcePack]
		{
			name = LCH4O
			title = Methalox
			descriptionSummary = <b>Inputs</b>: 4.779 LCH4/s + 1.593 OX/s <br><br><color="orange">Please quicksave + quickload after applying.</color>
			primaryColor = ResourceColorLqdMethane
			secondaryColor = ResourceColorOxidizer
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleResourceConverter
					ConverterName = Dark Mass Production
				}
				DATA
				{
					INPUT_RESOURCE
					{
						ResourceName = ElectricCharge
						Ratio = 5000
					}
					INPUT_RESOURCE
					{
						ResourceName = LqdMethane
						Ratio = 4.77948
					}
					INPUT_RESOURCE
					{
						ResourceName = Oxidizer
						Ratio = 1.59316
					}
				}
			}
		}
	}
}