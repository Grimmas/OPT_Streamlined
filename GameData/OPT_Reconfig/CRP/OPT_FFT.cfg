RESOURCE_DEFINITION
{
	name = OBH
	displayName = OPT Black Hole
	abbreviation = OBH
	density = 10
	unitCost = 0
	flowMode = NO_FLOW
	transfer = NONE
	isTweakable = False
	isVisible = True
	volume = 5
	ksparpicon = OPT_Reconfig/Resources/DarkGoo
	RESOURCE_DRAIN_DEFINITION
	{
		isDrainable = False
		showDrainFX = False
		drainFXPriority = 9
		drainForceISP = 5
		drainFXDefinition = particlesDraining
	}
}

B9_TANK_TYPE:NEEDS[B9PartSwitch,FarFutureTechnologies]
{
	name = OPTAM
	tankMass = 0.00512
	tankCost = 7.5
	RESOURCE
	{
		name = Antimatter
		unitsPerVolume = 5
	}
}

@PART:HAS[#manufacturer[OPT*Division],@MODULE[ModuleB9PartSwitch]]:NEEDS[B9PartSwitch,FarFutureTechnologies]
{
	MODULE
	{
		name = ModuleAntimatterTank
		FuelName = Antimatter
		ContainmentCost = 10
		DetonationKJPerUnit = 36000 
		DetonationRate = 5
	}
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[OPTcmd]]
	{
		SUBTYPE
		{
			name = D
			tankType = Deuterium
			title = Deuterium
			primaryColor = PowderBlue
			secondaryColor = PowderBlue
		}
		SUBTYPE
		{
			name = He3
			tankType = He3
			title = LqdHe3
			primaryColor = CloudyBlue
			secondaryColor = CloudyBlue
		}
		SUBTYPE
		{
			name = DHe3
			tankType = DeuteriumHe3
			title = LqdDeuterium + LqdHe3
			primaryColor = PowderBlue
			secondaryColor = CloudyBlue
		}
		SUBTYPE
		{
			name = FP
			tankType = FusionPellets
			title = FusionPellets
			primaryColor = Ocean
			secondaryColor = Ocean
		}
		SUBTYPE
		{
			name = FiP
			tankType = FissionPellets
			title = FissionPellets
			primaryColor = Amber
			secondaryColor = Amber
		}
		SUBTYPE
		{
			name = AM
			tankType = OPTAM
			title = Antimatter
			primaryColor = red
			secondaryColor = red
		}
	}
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[OPTcabin]]
	{
		SUBTYPE
		{
			name = D
			tankType = Deuterium
			title = Deuterium
			primaryColor = PowderBlue
			secondaryColor = PowderBlue
		}
		SUBTYPE
		{
			name = He3
			tankType = He3
			title = LqdHe3
			primaryColor = CloudyBlue
			secondaryColor = CloudyBlue
		}
		SUBTYPE
		{
			name = DHe3
			tankType = DeuteriumHe3
			title = LqdDeuterium + LqdHe3
			primaryColor = PowderBlue
			secondaryColor = CloudyBlue
		}
		SUBTYPE
		{
			name = FP
			tankType = FusionPellets
			title = FusionPellets
			primaryColor = Ocean
			secondaryColor = Ocean
		}
		SUBTYPE
		{
			name = FiP
			tankType = FissionPellets
			title = FissionPellets
			primaryColor = Amber
			secondaryColor = Amber
		}
		SUBTYPE
		{
			name = AM
			tankType = OPTAM
			title = Antimatter
			primaryColor = red
			secondaryColor = red
		}
	}
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[OPTbody]]
	{
		SUBTYPE
		{
			name = D
			tankType = Deuterium
			title = Deuterium
			primaryColor = PowderBlue
			secondaryColor = PowderBlue
		}
		SUBTYPE
		{
			name = He3
			tankType = He3
			title = LqdHe3
			primaryColor = CloudyBlue
			secondaryColor = CloudyBlue
		}
		SUBTYPE
		{
			name = DHe3
			tankType = DeuteriumHe3
			title = LqdDeuterium + LqdHe3
			primaryColor = PowderBlue
			secondaryColor = CloudyBlue
		}
		SUBTYPE
		{
			name = FP
			tankType = FusionPellets
			title = FusionPellets
			primaryColor = Ocean
			secondaryColor = Ocean
		}
		SUBTYPE
		{
			name = FiP
			tankType = FissionPellets
			title = FissionPellets
			primaryColor = Amber
			secondaryColor = Amber
		}
		SUBTYPE
		{
			name = AM
			tankType = OPTAM
			title = Antimatter
			primaryColor = red
			secondaryColor = red
		}
	}
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[OPTwing]]
	{
		SUBTYPE
		{
			name = D
			tankType = Deuterium
			title = Deuterium
			primaryColor = PowderBlue
			secondaryColor = PowderBlue
		}
		SUBTYPE
		{
			name = He3
			tankType = He3
			title = LqdHe3
			primaryColor = CloudyBlue
			secondaryColor = CloudyBlue
		}
		SUBTYPE
		{
			name = DHe3
			tankType = DeuteriumHe3
			title = LqdDeuterium + LqdHe3
			primaryColor = PowderBlue
			secondaryColor = CloudyBlue
		}
		SUBTYPE
		{
			name = FP
			tankType = FusionPellets
			title = FusionPellets
			primaryColor = Ocean
			secondaryColor = Ocean
		}
		SUBTYPE
		{
			name = FiP
			tankType = FissionPellets
			title = FissionPellets
			primaryColor = Amber
			secondaryColor = Amber
		}
		SUBTYPE
		{
			name = AM
			tankType = OPTAM
			title = Antimatter
			primaryColor = red
			secondaryColor = red
		}
	}
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[OPTtail]]
	{
		SUBTYPE
		{
			name = D
			tankType = Deuterium
			title = Deuterium
			primaryColor = PowderBlue
			secondaryColor = PowderBlue
		}
		SUBTYPE
		{
			name = He3
			tankType = He3
			title = LqdHe3
			primaryColor = CloudyBlue
			secondaryColor = CloudyBlue
		}
		SUBTYPE
		{
			name = DHe3
			tankType = DeuteriumHe3
			title = LqdDeuterium + LqdHe3
			primaryColor = PowderBlue
			secondaryColor = CloudyBlue
		}
		SUBTYPE
		{
			name = FP
			tankType = FusionPellets
			title = FusionPellets
			primaryColor = Ocean
			secondaryColor = Ocean
		}
		SUBTYPE
		{
			name = FiP
			tankType = FissionPellets
			title = FissionPellets
			primaryColor = Amber
			secondaryColor = Amber
		}
		SUBTYPE
		{
			name = AM
			tankType = OPTAM
			title = Antimatter
			primaryColor = red
			secondaryColor = red
		}
	}
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[OPTcargo]]
	{
		SUBTYPE
		{
			name = D
			tankType = Deuterium
			title = Deuterium
			primaryColor = PowderBlue
			secondaryColor = PowderBlue
		}
		SUBTYPE
		{
			name = He3
			tankType = He3
			title = LqdHe3
			primaryColor = CloudyBlue
			secondaryColor = CloudyBlue
		}
		SUBTYPE
		{
			name = DHe3
			tankType = DeuteriumHe3
			title = LqdDeuterium + LqdHe3
			primaryColor = PowderBlue
			secondaryColor = CloudyBlue
		}
		SUBTYPE
		{
			name = FP
			tankType = FusionPellets
			title = FusionPellets
			primaryColor = Ocean
			secondaryColor = Ocean
		}
		SUBTYPE
		{
			name = FiP
			tankType = FissionPellets
			title = FissionPellets
			primaryColor = Amber
			secondaryColor = Amber
		}
		SUBTYPE
		{
			name = AM
			tankType = OPTAM
			title = Antimatter
			primaryColor = red
			secondaryColor = red
		}
	}
	@MODULE[ModuleB9PartSwitch]:HAS[#moduleID[OPTdrop]]
	{
		SUBTYPE
		{
			name = D
			tankType = Deuterium
			title = Deuterium
			primaryColor = PowderBlue
			secondaryColor = PowderBlue
			transform = LiquidFuel
		}
		SUBTYPE
		{
			name = He3
			tankType = He3
			title = LqdHe3
			primaryColor = CloudyBlue
			secondaryColor = CloudyBlue
			transform = Oxidizer
		}
		SUBTYPE
		{
			name = DHe3
			tankType = DeuteriumHe3
			title = LqdDeuterium + LqdHe3
			primaryColor = PowderBlue
			secondaryColor = CloudyBlue
			transform = LiquidFuel
		}
		SUBTYPE
		{
			name = FP
			tankType = FusionPellets
			title = FusionPellets
			primaryColor = Ocean
			secondaryColor = Ocean
			transform = LiquidFuel
		}
		SUBTYPE
		{
			name = FiP
			tankType = FissionPellets
			title = FissionPellets
			primaryColor = Amber
			secondaryColor = Amber
			transform = LiquidFuel
		}
		SUBTYPE
		{
			name = AM
			tankType = OPTAM
			title = Antimatter
			primaryColor = red
			secondaryColor = red
			transform = Oxidizer
		}
	}
}

@PART[engine_darkDrive]:NEEDS[!OPT_DarkGoo]
{
	@MODULE[ModuleEnginesFX]
	{
		@maxThrust = 500 // 1500
		@heatProduction = 900 // 450
		status = Safety Open
		statusL2 = Safety Locked
		useThrustCurve = True
		!PROPELLANT[LiquidFuel] {}
		!PROPELLANT[Oxidizer] {}
		PROPELLANT
		{
			name = ElectricCharge
			ratio = 0.01
			DrawGauge = True
			minResToLeave = 2000
		}
		PROPELLANT
		{
			name = OBH
			ratio = 1
			DrawGauge = True
		}
		@atmosphereCurve
		{
			!key,* = nope
			key = 0 299000000
			key = 0.01 0.001
		}
		thrustCurve
		{
			key = 0 3 0 -6.2
			key = 1 1 0 0
		}
	}
	MODULE
	{
		name = ModuleAlternator
		engineIndex = 1
		outputName = Mag Shield Power Draw
		outputUnits = EC/s
		RESOURCE
		{
			name = ElectricCharge
			rate = -500
		}
	}
	MODULE
	{
		name = ModuleResourceConverter
		ConverterName = Dark Mass Production
		StartActionName = Start Dark Mass Production
		StopActionName = Stop Dark Mass Production
		ToggleActionName = Toggle Dark Mass Production
		GeneratesHeat = True
		UseSpecialistBonus = False
		AutoShutdown = True
		TemperatureModifier
		{
			key = 0 100000 0 0
			key = 2000 50000 -44.38715 -44.38715
			key = 3000 0
		}
		DefaultShutoffTemp = .8
		ThermalEfficiency 
		{
			key = 0 0 0 0
			key = 2000 1 0 0
			key = 3000 0 0 0
		}
		INPUT_RESOURCE
		{
			ResourceName = ElectricCharge
			Ratio = 5000
		}
		INPUT_RESOURCE
		{
			ResourceName = Ore
			Ratio = 0.1
		}
		OUTPUT_RESOURCE
		{
			ResourceName = OBH
			Ratio = 0.01
		}
	}
	
	MODULE
	{
		name = ModuleCoreHeat
		CoreTempGoal = 2000					//Internal temp goal - we don't transfer till we hit this point
		CoreToPartRatio = 0.1				//Scale back cooling if the part is this % of core temp
		CoreTempGoalAdjustment = 0			//Dynamic goal adjustment
		CoreEnergyMultiplier = 0.1			//What percentage of our core energy do we transfer to the part
		HeatRadiantMultiplier = 0.05		//If the core is hotter, how much heat radiates?
		CoolingRadiantMultiplier = 0		//If the core is colder, how much radiates?
		HeatTransferMultiplier = 0			//If the part is hotter, how much heat transfers in?
		CoolantTransferMultiplier = 0.01	//If the part is colder, how much of our energy can we transfer?
		radiatorCoolingFactor = 1			//How much energy we pull from core with an active radiator?  >= 1
		radiatorHeatingFactor = 0.05		//How much energy we push to the active radiator
		MaxCalculationWarp = 1000			//Based on how dramatic the changes are, this is the max rate of change
		CoreShutdownTemp = 4000				//At what core temperature do we shut down all generators on this part?
		MaxCoolant = 3000					//Maximum amount of radiator capacity we can consume - 50 = 1 small
	}
	MODULE
	{
		name = ModuleGenerator
		isAlwaysActive = True
		INPUT_RESOURCE
		{
			name = OBH
			rate = 0.000004
			resourceFlowMode = NO_FLOW
		}
		OUTPUT_RESOURCE
		{
			name = ElectricCharge
			rate = 3
		}
	}
	RESOURCE
	{
		name = OBH
		amount = 0
		maxAmount = 1
	}
}

// @PART[opt_vtol_bubble1]
// {
	// @MODULE[ModuleEnginesFX],1
	// {
		// @maxThrust = 240
		// @heatProduction = 140
		// @PROPELLANT[ElectricCharge]
		// {
			// @ratio = 0.1
		// }
		// @atmosphereCurve
		// {
			// key = 0 4000
			// key = 1 1800
			// key = 4 0.001 0 0
		// }
	// }
	// MODULE
	// {
		// name = ModuleAlternator
		// engineIndex = 1
		// outputName = Reactor Power Draw
		// outputUnits = EC/s
		// RESOURCE
		// {
			// name = ElectricCharge
			// rate = -140
		// }
	// }
// }